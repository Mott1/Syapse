{# Inherits variables from pages/_router: #}
{# @articles - the articles to output #}
{# @sectionTitle - the title of the news section #}
{# @isCategory - is this news section a category #}

{% extends "layouts/_layout" %}

{% block content %}

    {# Set the cache key based on the url segments #}
    {% set cacheKey = "page" %}
    {% for key in craft.request.getSegments() %}
        {% set cacheKey = cacheKey ~ "_" ~ key %}
    {% endfor %}
    {% cache globally using key cacheKey if craft.config.cache %}

        <div class="core-content">

            {% if entry is defined and entry.slug == "blog" %}

                {% include 'includes/headers/_blogPost-header' with { entry: articles.first(), linkPostTitle: true } %}
                {% set articles = articles.offset(1) %}

            {% else %}

                {% set heading = sectionTitle %}
                {% set preHeading = "" %}

                {% if isCategory is defined and isCategory %}
                    {% set preHeading = "Blog" %}
                    {% set heading = sectionTitle %}            
                {% endif %}

                {% set params = {
                    heading: heading,
                    preHeading: preHeading
                } %}

                {% include 'includes/headers/_standard-header' with params %}

            {% endif %}

            <div class="listing-container">

                <div class="global-wrapper">

                    {% include 'includes/partial/_article-list' %}
                    {% include 'includes/partial/_sidebar' %}

                </div>

            </div>

        </div>

    {% endcache %}

{% endblock %}